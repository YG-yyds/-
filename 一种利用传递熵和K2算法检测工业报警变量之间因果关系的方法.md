# 一种利用传递熵和K2算法检测工业报警变量之间因果关系的方法

## 研究内容

论文以传递熵理论和贝叶斯网络K2算法的结构学习为基础，提出了一种检测工业报警变量之间因果关系的新方法。该方法认为，检测这些关系有助于减少警报管理系统中的警报数量，避免在工厂故障时的操作员过载。该方法能够检测因果关系并确定报警的根本原因。论文使用全厂模拟器Tennessee Eastman Process进行案例研究来验证该方法，在本研究中，通过该方法获得的因果关系图与系统功能兼容。

## 解决问题

论文解决了如何检测工业报警变量之间的因果关系的问题。该方法通过检测报警变量之间的因果关系，确定报警的根本原因，有效的减少了工业报警管理系统中的报警泛滥和操作员过载，帮助提高报警管理系统的效率和准确性。

## 解决思路



## 基础理论

### 传递熵 Transfer Entropy(TE)

传递熵是一种用于测量变量之间的动态信息传递的技术度量，通过计算传递熵，可以动态的量化两个变量序列间的信息交换量和信息从一个序列到另一个序列的传递方向。

给定两个随机变量I和J，假设I和J是两个离散时间序列，TE使用两个序列过去的一组样本来验证I的未来是否受到J过去的影响。

构建向量 $i^{k} = [i\_{t}, ..., i\_{t-k+1}]$ 和 $j^{l} = [j\_{t}, ..., j\_{t-l+1}]$ ，上标代表时间范围，定义变量过去使用的样本数量。参数h表示变量I的预测范围，指示I的未来将被分析多远。

$$TE\_{J \rightarrow I} = \sum\_{i, i\_{t+h}, j} {p(i\_{t+h}, i^{k}\_{t}, j^{l}\_{t}) log \frac{p(i\_{t+h} | i^{k}\_{t}, j^{l}\_{t})}{p(i\_{t+h} | i^{k}\_{t})}}$$

通过上述等式计算传递熵，使用联合概率 $p(i\_{t+h}, i^{k}\_{t}, j^{l}\_{t})$ 以及条件概率 $p(i\_{t+h} | i^{k}\_{t}, j^{l}\_{t})$ 和 $p(i\_{t+h} | i^{k}\_{t})$ 来识别序列之间的有向信息交换。本文使用传递熵计算的Bauer形式，预测范围h可变。

### 贝叶斯网络上的结构学习

#### 贝叶斯网络

贝叶斯网络是基于有向无环图的概率模型，节点表示兴趣点变量，连接表示信息或因果依赖关系。

令G = (I,E)表示一个有向无环图，I代表所有的节点的集合，而E代表有向连接线段的集合，令 $x = (x\_{i}), i \in I$ 为节点i所代表的随机变量，节点x的联合概率可以表示成: $p(x) = \prod\_{i \in I} p(x\_{i} | x\_{pa(i)})$ ，其中pa(i)表示节点i的"因"/父节点。

对于任意随机变量，其联合概率可由各自的条件概率分布相乘得出: $p(x\_{1},...,x\_{K}) = p(x\_{K} | x\_{1},...,x\_{K-1}) \cdot \cdot \cdot p(x\_{2} | x\_{1}) p(x1)$

#### 三种方法

贝叶斯网络结构学习的三种方法：基于评分的方法、基于约束的方法和混合方法。

- 基于评分的方法：试图找出一种使评分函数最大化的拓扑结构，该函数试图根据输入数据找到网络的最佳拓扑。
- 基于约束的方法：使用条件独立性测试评估变量相关性并推断因果关系。
- 混合方法：同时存在评分策略和约束策略。

#### K2算法

K2算法是一种基于评分的贝叶斯网络结构学习算法，需要对节点进行预先排序，以定义节点的网络结构。为识别网络变量如何相互影响，K2提出一种使用先前的变量排序来计算最可能的因果结构的方法。该算法试图找到贝叶斯结构 $B\_s$ 使 $P(B\_s, D)$ 最大化，D为给定数据库。

$$P(B\_s, D) = c \prod ^{n}\_{i=1} \prod ^{q\_i}\_{j=1} {\frac {(r\_i -1)!}{(N\_{ij} + r\_i -1)!}} \prod ^{r\_i}\_{k=1} {N\_{ijk}!}$$

$$N\_{ij} = \sum ^{r\_i}\_{k=1} {N\_{ijk}}$$

D是给定数据库；n是网络中的节点数量； $q\_{i}$ 是节点的父集合的唯一实例化次数； $r\_{i}$ 是节点所假定的所有可能值的数目； $N\_{ijk}$ 是D中节点用第k个值实例化，节点的父节点用第j个值实例化的情况数。

为使等式最大化，需要找到使内积最大化的父集，K2算法将计算该部分的函数定义为 $g(i, \pi \_{i})$ ，称为Cooper-Herskovits度量，它测量父集 $\pi \_i$ 成为节点 $x\_i$ 的正确父集的概率。

$$g(i, \pi \_{i}) = \prod ^{q\_i}_{j=1} {\frac {(r\_i -1)!}{(N\_{ij} + r\_i -1)!}} \prod ^{r\_i}\_{k=1} {N\_{ijk}!}$$

## 实验过程



------

**原文**

A method for detecting causal relationships between industrial alarm variables using Transfer Entropy and K2 algorithm

**出版**

- Journal of Process Control 106 (2021) 142-154

**申明**

版权归原文作者及出版单位所有，如有侵权请联系删除

