# VULNUS: 网络安全的可视化漏洞分析

## 简介

软件漏洞是网络攻击的切入点，发挥核心作用，软件开发者生产补丁修复它们，然而修补程序可能因组织任务限制对应用造成障碍。网络安全管理人员需处理大量漏洞，试图全面了解情况，确定干预措施优先次序，选择适当修复措施(应用补丁，关闭IP端口，隔离有漏洞的节点)。新的挑战：在分析中包括入侵者可能遵循的攻击路径，找到使大型漏洞集有意义的解决方案等。

VULNUS(vulnerabilities visual assessment)可用于可视化漏洞分析，计算每个漏洞在攻击路径中的作用并将其与评估特征(CVSS指标)一起可视化。目标是提高安全管理人员的态势感知，为他们提供检测和优先修复漏洞的手段。建议的解决方案允许动态检查网络漏洞特征，模拟漏洞修复对系统的影响，可以快速了解: a. 网络状态，根据其漏洞对节点进行可视化分类; b. 漏洞的影响，对关键节点造成的风险; c. 近似最佳修复策略，阻断所有攻击路径。安全管理人员可以根据资源、时间、业务限制，应用建议的解决方案或确定不同的次优修复策略。

**文章贡献：**
- 一个修改后的树形图条形图可视化，与多个协调面板和过滤机制集成在一起，允许理解分布在多个子网上的大量漏洞
- 一个自动计算的基于攻击图的分析得分，即目标环境得分，对标准CVSS得分进行补充，提供关于漏洞严重程度的信息，即它们对破坏的关键目标节点的贡献
- 一个假设模拟场景，允许用户了解修复漏洞的效果：用户可以交互地探索和修改优先分析策略的结果，该策略自动计算能够阻止所有现有攻击路径的近似最佳修复序列
- 一个受控用户的研究，通过实验室测试实验评估所提出的解决方案的有效性和效率

**相关工作：**

视觉分析技术在网络安全领域的应用包括许多不同的主题，如网络状态、入侵检测、日志和代码分析。节点中存在漏洞是一个关键的网络安全问题，漏洞利用是攻击/渗透网络的的第一步，安全管理员必须处理非传统威胁(如与已知但无法修补的漏洞共存)。

相关研究大多集中在网络事件的可视化和不同层次的细节分析上，比如使用树状图可视化安全数据和事件，但没有应对漏洞。大多数网络安全商业工具提供的关于漏洞的可视化信息有限，处理漏洞的方式大多是表格和简单的可视化范式(柱状图、饼状图等)。VisiTrend工具提出一个视觉环境，以节点-链状图、树状图表示网络拓扑结构，并在上面绘制网络安全参数。NV利用树状图和链接直方图，允许安全管理人员发现、分析、管理网络漏洞，是一个基于网络的解决方案。关于分析引擎，VULNUS引入“目标环境”的概念，扩展“许多δ-最优路径共用的边可能代表漏洞点”的想法，以及“攻击临界度得分”的概念，用于对“许多成功的攻击方法所使用的攻击能力”进行评分。

## 应用域

介绍攻击图方法和CVSS指标的高层次概述。

### 攻击图

攻击图用于模拟和更好的理解攻击者为达到其目标可能执行的各种连续步骤。每个步骤由利用节点(属于网络节点集N)上的漏洞(属于网络漏洞集V)获得对其资源的非预期访问来表示。

目标节点T: 攻击者的目标节点，通常是任务关键节点。源节点S: 攻击者可以用来发起多步骤攻击的节点，对应于网络上可见的节点。从一个源节点开始到达一个目标节点的步骤序列是一个攻击路径，所有攻击路径AP的联合产生攻击图。

ap被建模为一连串利用步骤: ap = < n0 >, < v1, n1 >, ..., < vk, nk >, 代表从源节点n0到目标节点nk的一条路径。
所有可能的漏洞利用的集合ES: 出现在任何攻击路径中的所有< v, n >的集合。

攻击图常被用来显示通往目标节点的可能路径或实际攻击的进展，本文用来将目标环境得分与每对＜漏洞，节点＞相关联，反映其允许到达的目标节点的漏洞关键性。

### CVE和CVSS

CVE(Common Vulnerability and Exposures): 常见漏洞和暴露，CVE NIST国家漏洞数据

CVSS(Common Vulnerability Scoring System): 常见漏洞评分系统

CVSS将漏洞严重性指标分为三组，每组有自己的评分，用于计算总分，范围为0-10，总结整个漏洞的严重程度: 

1. 基础分，基本指标(必须)，代表漏洞不可改变的方面，如利用漏洞所需的复杂性信息(利用性得分)，利用漏洞对存在漏洞节点的影响
2. 时间分，时间指标(可选)，代表可能随时间变化的方面
3. 环境分，环境指标(可选)，漏洞对其所在环境的影响

CVSS结构复杂性使大多网络安全管理人员只检查总分而忽略了细节，VULNUS试图解决该问题，以视觉方式编码基础分、本文定义的目标环境分、作为基础分关键部分的可利用性分，使人更易了解到节点状态和漏洞主要特征，不同于CVSS，系统考虑到网络拓扑结构，依赖目标环境分，以对目标节点的潜在影响描述漏洞利用的影响。

## 活动和任务收集

实施VULNUS前，ACEA安全操作员使用像Nessus这样的漏洞扫描工具，通过经常性的漏洞扫描监控网络，Nessus根据CVSS将漏洞分为五个严重程度(关键、高、中、低、信息)，产生按漏洞或主机组织的文本报告，若有新漏洞在“关键/高”范围或影响相关服务器，则决定修复计划平衡其严重性和业务限制。

安全操作员工作: 监控网络状态，分析漏洞严重程度，对修复计划做决定。VULNUS目标是更好支持这些阶段，作者与ACEA公司相关人员进行需求收集，确定与网络漏洞管理有关的主要活动，结果总结如下(RXy标注主要原始用户需求)：

R1-监测：在每次有新的扫描时进行，允许安全经理快速识别可能存在风险的区域，深入了解环境整体状态

- R1a-顶层概述：允许安全经理确定全局网络漏洞的位置和需要详细分析的内容
- R1b-变化识别：允许安全管理员跟踪由于几个事件引起的漏洞状态变化

R2-分析：允许安全经理对构成环境的元素进行分析

- R2a-节点驱动分析：以节点(网络单一设备)为基础，可以理解和评估网络的一组节点的网络安全状况
- R2b-漏洞驱动分析：从网络中出现的漏洞开始分析，比如评估一个特定的漏洞在网络中的传播，与其他已知漏洞比较，对实例化节点造成的风险和对整个网络造成的风险
- R2c-衡量标准驱动分析：使用漏洞的数字特征进行分析，按不同的分数对元素进行分组

R3-假设分析：允许安全经理决定修复计划，检查自动生成的最佳修复策略，根据业务限制对其调整，模拟修复对网络的影响，减少漏洞暴露和相关风险

## VULNUS解决方案

VULNUS将来自漏洞和网络扫描仪(OpenVas, Nessus, LanGuard)的数据结合，这些数据能识别影响被检查节点及其连接的一组漏洞，人工干预只需定义源节点集，有关漏洞的数据与CVE和CVSS中指标和定义相匹配，这些数据与连接性、源节点、目标节点一起被用来计算与扫描网络相关的攻击图。

### 1. 分析部分

通过攻击图信息可以对目标环境评分并对漏洞修复进行优先排序，考虑两种类型漏洞：

1. 不涉及任何开发步骤的漏洞。仅对其存在的节点构成安全风险，由标准CVSS评分描述。
2. 至少在一个开发步骤中涉及的漏洞。对所到达的目标节点也存在安全风险，由标准CVSS评分和目标环境评分描述。

#### 计算目标环境得分

#### 漏洞修复的优先次序

### 2. 可视化组件
