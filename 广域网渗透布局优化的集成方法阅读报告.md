# 广域网渗透布局优化的集成方法阅读报告

## 1.摘要与介绍

基于物联网的网络的复杂性和新漏洞的指数级增长增加了对安全评估策略的需求。攻击图或渗透布局在加固和分析此类复杂网络方面发挥着至关重要的作用。随着网络复杂性增长，不同层次的连接可能会导致更高的风险，并且管理员可能会发现很难理解渗透布局。本文提出了一种方法来弥合大型网络和渗透布局之间的差距，从而实现一种自动生成、优化和改进大型网络渗透布局可视化的策略。更具体地说，将网络模型作为设计的模拟器的输入，模拟器分析网络并生成渗透布局。此外，本文还设计了一种算法，以在不同级别优化贯穿件布局的大小，这也将改善图形的可视化。本文设计了一个模拟器，使用实时网络蓝图来可视化和分析所提出的方法的效果和性能。结果表明，对于示例实时网络，渗透布局的大小无损地减少了99.95%。

### 连锁漏洞和渗透布局

**渗透布局：**

由于网络场景广泛，仅考虑单个系统相关的孤立漏洞不够，需要考虑使用连锁漏洞。计算系统连接在一个可能会引入各种安全漏洞的网络中。漏洞可以在形成链的序列中被利用，以实现最终目标。该漏洞数据与连接策略一起用于生成攻击图，也成渗透布局。

渗透布局是各种渗透场景的组合，每一个渗透场景都是对不同机器的一系列攻击，导致它们进入不希望的状态。

攻击图生成的完整过程：

<img src="pic\p1\fig1.png" width="70%" />

**渗透布局在确保网络安全（分析和防御）方面的作用：**

1.可用来检测攻击者进入网络的方式。此外，可从渗透场景中分析风险更大的漏洞。

2.我们可以预测为防止攻击者到达目标而应采取的一组漏洞或行动，即我们可以先修补风险更大的漏洞。

## 2.相关工作——攻击图的研究史

攻击图或渗透布局的研究领域主要分为三个方面，即攻击图生成、可扩展性和优化以及攻击图风险分析。

**攻击图生成：**

特权图->攻击树->场景图->目标计划图->攻击状态转换图（ASTG）/主机级攻击图（HLAG）->依赖图/贝叶斯攻击图->网络攻击图

ASTG：节点表示攻击者状态，边缘表示攻击者在前一步骤中连续移动，易于设计和开发，难以可视化和理解。

HLAG：节点描绘有关主机的信息，这些主机按顺序被利用以获得目标主机。节点比ASTG少，需要维护大型前置条件后处理数据集。

依赖图/贝叶斯攻击图：克服攻击图的大小问题。贝叶斯攻击图用于表示下一次可能的攻击，具体取决于前一次攻击的执行概率。漏洞利用依赖关系图由作为节点的漏洞构成，每个边缘对应于与前一个漏洞接连的下一个漏洞，单独为单个主机生成。

网络攻击图：网络中所有可能的攻击路径。分析完整网络场景的有用工具，存在可伸缩性问题和冗余路径问题。

**攻击图的优化和可扩展性：**

为缓解目标图大小和复杂性随网络复杂性增加而增加的问题，Farmad研究了贝叶斯攻击图减少状态爆炸，Kaynar使用并行方法生成分布式攻击图减少运行时间，但是图形可视化没得到很大改善，且并未解决图优化问题。另外，一些作者致力于攻击图的子网优化。

**攻击图风险分析：**

如今，攻击图中的漏洞分析成为研究人员面临的重大挑战。研究人员已讨论许多方案分析和优先考虑脆弱性。Chao提供了一种算法成为避免攻击路径的最佳解决方案之一。研究人员还提出一些混合技术结合多种方案优势获得更好结果。

## 3.攻击模型和渗透布局

讨论与渗透布局组件一起使用的攻击模型，以创建渗透布局。

**攻击模型：**

攻击模型由定义攻击者行为的方式表示。

Def：攻击模型AM=(A,θ,A_0)，A:状态，θ:从一个状态到另一个状态的可达性，A_0:根的状态。状态A是以下四个元素的组合AM=(N,v,S_t,D_t)，N:状态数，v:已分配CVE Id的安全缺陷 (CVE:通用漏洞披露)，S_t:生成攻击的源系统id，D_t:对其执行攻击的目标系统id。

**渗透布局组件：**

*节点：* 节点是运行服务、执行操作的系统，以及一些机密数据的存储中心。入侵者的举动针对某个主机，将其转为不安全状态。一个节点的渗透布局可用AM=(N,v,S_t,D_t)表示。

*边：* 连接两个节点，也可表示两个系统间的连接关系。

Def：每条边都是一个有限自动机 E=(P,S)，S:目标系统，入边表示攻击S漏洞所需的特权P，出边表示攻击S漏洞后获得的特权P。

**渗透布局：**

漏洞利用依赖关系图作为基础模型，进一步缩小图大小（节点与边的数量）来描述网络行为。

*样本渗透布局：*

漏洞利用依赖关系图：

<img src="pic\p1\fig2.png" width="60%" />

C表示条件，E表示漏洞利用。

*拟定渗透布局生成方案：*

修改漏洞利用依赖关系图，为节点和边添加详细信息。该过程进一步减少节点的数量，因为不需要条件节点，同时提高了布局的可读性。

## 4.网络蓝图

**系统和漏洞：**

网络系统由各种漏洞组成，取决于其上运行的服务。详细的漏洞数据库、前置条件和后置条件数据集以及网络的连接关系用于生成渗透布局。

**渗透布局：**

具有LAN连接的内部主机可以相互访问。攻击者主机首先利用可直接访问的系统，然后向其他内部主机前进，形成渗透场景。渗透布局是渗透场景的组合。
