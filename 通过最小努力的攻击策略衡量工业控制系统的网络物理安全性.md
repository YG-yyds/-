# 通过最小努力的攻击策略衡量工业控制系统的网络物理安全性

由于工业控制系统(ICS)越来越多暴露在各种网络攻击下，产生巨大后果，安全度量对评估和改善其安全状况至关重要。本文提出一种基于AND/OR图和超图的新型ICS安全度量，能有效识别出攻击者以最小成本破坏关键ICS组件和安全措施的集合。本文的工具META4ICS利用逻辑可满足性优化和MAX-SAT技术领域算法实现高效的计算时间。本文通过分析一个现实水运输网络(WTN)的安全态势作为案例研究。

## 简介

工业控制系统(ICS)与外界联系越发紧密，且缺乏对网络攻击的准备，这些网络攻击可能产生巨大影响，保护ICS不受网络威胁成为一个高度优先事项。由于原本被设计成独立工作的ICS环境进入一个超级连接的世界，产生了难以控制和保护的复杂生态系统，所以尽管有指南和标准的最佳实践来提高ICS安全性，但网络事件的数量仍在不断增加。

Fig.1展示了一个大规模水分配网络(WDN)，说明了这些网络的规模和复杂性。这种情况下安全指标发挥根本性作用，因为它们允许我们了解ICS环境的暴露性和脆弱性，并改善其安全态势。识别应该优先处理的关键网络物理组件的能力至关重要。AND/OR图能从语义上把握ICS组件间的复杂逻辑关系，在该领域非常有用。识别AND/OR图的关键节点是一个NP-complete问题。ICS环境涉及各种网络和物理安全措施，以重叠的方式同时保护多个ICS组件，使该问题更加困难。本文中这些组件被定义为它们在系统运行中的整体作用与保护它们的相对安全强度之间的平衡点。将特定ICS环境最小努力攻击策略定义为攻击者以最小成本(努力)破坏的关键节点和安全措施的集合，以破坏重要ICS资产的运行，将这一概念作为衡量ICS系统安全水平的基线。

<img src="pic\p6\fig1.png" width="50%" />

**贡献：**

- 一个能代表受多种重叠安全措施保护的ICS环境中的复杂依赖关系的数学模型
- 一个新的安全指标和有效的算法来识别关键的网络物理组件
- 一个名为META4ICS的开源工具，用于分析真实的ICS模型
- 在性能和可扩展性方面进行了广泛的实验评估
- 在一个现实的水运港口网络上进行了全面的案例研究，显示了本文的安全指标的适用性

## 方法概述

### 激励性例子

<img src="pic\p6\fig2.png" width="50%" />

Fig.2展示一个简单的AND/OR图，涉及5个原子节点形式的CPS组件：2个传感器(a和c)，2个软件代理(b和d)，1个执行器(t)。执行器t取决于软件代理d的输出，软件代理d有两种选择：使用传感器a的读数和软件代理b的输出；使用传感器c的读数和软件代理b的输出。

假设每个CPS组件有一个表示其折衷成本(攻击者的努力)的权重，inf代表无限。试图回答问题：禁用(破坏)执行器t的最小攻击策略是什么(攻击者的努力成本最小)？

Fig.2所示情况下，攻击者的最佳策略是以4的总成本破坏节点a和c。从防御的角度看，这一最低成本代表系统安全级别的指标。

<img src="pic\p6\fig3.png" width="50%" />

Fig.3为更普遍的情况，需要考虑两方面的问题：一方面需要确定可以在AND/OR图中断开目标与其依赖关系的关键组件；另一方面，最大限度地减少联合应用以同时保护多个ICS组件的安全措施所造成的攻击。

在第二种情况下，传感器a和c由相同的安全措施s1保护，因此绕过s1损害传感器a和c的成本为2。传感器a也受到安全措施s3的保护，因此损害传感器a需要绕过s1和s3。因此，最好的策略是折衷安全措施s1和s3，涉及关键节点a和c，总成本为2+1=3。

### 总体技术方法

本文的方法以表示ICS环境的操作依赖性的有向图G=(V,E)的形式，将一个AND/OR图作为输入，并将该图转换为满足目标节点t的等效逻辑公式。安全措施通过AND/OR超图集成到模型中，通过合并应用于每个节点的安全措施的逻辑表示来扩展这个公式。该公式的逻辑非对应于攻击者的目标，即禁用t，随后通过使用Tseitin变换将t转换为合取范式(CNF)中的等价满足公式。最后，以CNF公式为基础，建立了加权偏MAX-SAT问题。这个问题的解决方案是关于节点t的G中的最小加权顶点割，以及保护ICS组件的所有安全措施。这一削减代表了一组对攻击者来说成本最低的关键组件，因此，如果被破坏，它将使网络物理系统进入非操作状态。

## 相关工作

21世纪初以来，展开了许多了解和改善工控系统和关键国家基础设施的安全的研究工作，这些工作激发了考虑ICS组件之间的网络物理依赖性的需求，并将它们结合以提供可量化的测量。本文根据破坏目标系统正常运行所需要被破坏的网络物理元素的数量来计算系统的网络物理安全等级，提供了一个完整的基于AND/OR图的框架，能够掌握CPS组件间复杂依赖关系和用于保护它们的安全措施。从图论的角度看，本文的方法是在AND/OR图中寻找一个最小加权顶点割，使用基于MAX-SAT的技术来识别受多种安全措施保护的关键节点。本文方法涵盖基于树的情况和一般的依赖图(内部节点可以有一个以上的父节点)。攻击图通常只考虑网络的横向移动，不考虑组件间的物理依赖，本文的工作是对攻击图的补充，并计划将攻击图作为一种更好的评估网络攻击带来的风险的手段纳入本文的方法。

## 网络-物理网络模型

### AND/OR依赖关系图

将工业网络W建模为一个有向的AND/OR图G=(V,E)，表示W中的操作依赖性。该图涉及3种类型的基本顶点，称为原子节点($V_AT$)，模拟网络中不同类别的组件。 $V_AT=S \cup C \cup A$ ,S代表传感器节点的集合，C代表执行器节点的集合，A代表软件代理节点的集合。该图还包括两种模拟网络组件间逻辑依赖关系的节点， $\Delta$ 代表AND节点的集合， $\Theta$ 代表OR节点的集合，所以 $V(G)=V_AT \cup \Delta \cup \Theta$ 。

E(G)对应节点之间边的集合，它们的意义取决于所连接的节点类型。

- 三种基本边：
  - $E_{A,C}= \\{ (a,c): a \in A \wedge c \in C \\}$ 代表代理a控制执行器c的操作
  - $E_{S,A}= \\{ (s,a): s \in S \wedge a \in A \\}$ 代表代理a需要传感器s的测量值
  - $E_{A,A}= \\{ (a_i,a_j): a_i,a_j \in A, a_i \neq a_j \\}$ 代表代理 $a_j$ 需要代理 $a_i$ 的输入才能正常运行
- 涉及AND/OR节点的两种类型的边：
  -  $E_{i\Delta\Theta}= \\{(v,x): v \in V-C, x \in \Delta \cup \Theta\\}$ 代表从除执行器(C)之外的任何类型的图节点到AND/OR节点的输入连接
  -  $E_{o\Delta\Theta}= \\{(x,v): x \in \Delta \cup \Theta, v \in V-S\\}$ 代表从除传感器(S)之外的任何类型的图节点到AND/OR节点的传出连接

图的属性: 令 $d\_{in}: V \rightarrow N, d\_{out}: V \rightarrow N$ 为两个函数，分别计算节点的入度和出度。图G=(V,E)的所有实例都有以下属性：

-  $d_{out}(c) = 0, \forall c \in C$ (没有来自执行器的外向边)
-  $d\_{in}(v) = 1, \forall v \in V\_{AT}$ (原子节点上只有一条传入边)
-  $d_{out}(v) \geq 1, \forall v \in \Theta \cup \Delta$ (逻辑节点与一些分界节点相连)
-  $d_{in}(v) \geq 2, \forall v \in \Theta \cup \Delta$ (逻辑节点结合两个或多个节点)

### 对抗性模型和假设

攻击者可以以一定的成本 $\phi (n)$ 压缩任何网络节点 $n \in V\_{AT}$ , $\phi : V\_{AT} \rightarrow R\_{\geq 0}$ 。成本 $\phi (n)$ 的目的是提供一种手段，定量的表达攻击者单独破坏一个给定节点n所需的努力。该成本函数的实例化在某些情况下比较困难，通用漏洞评分系统(CVSS)以数字分数的形式提供了量化软件漏洞的手段，反映漏洞严重程度。

由于CPS组件(图形节点)在逻辑上依赖于其他节点才能正常工作，一个节点的崩溃会影响依赖于它的节点的运行，在节点间形成逻辑式传播。

### 防御模式和安全措施

从防御的角度看，本文将安全措施建模为一个额外的层(覆盖层)，置于AND/OR依赖图之上，如Fig.3和Fig.4所示。每个ICS组件由一个或多个类型为M的安全措施实例s保护。Table 1举例说明了一些典型安全措施。

<img src="pic\p6\table1.png" width="60%" />

给定一个特定场景，将 $S=\\{s\_1, s_2, ...\\}$ 定义为所涉及的安全措施实例集，每种度量类型M都涉及攻击者的成本，该成本量化了攻击者为绕过度量必须付出的努力。将度量实例的这一方面建模为函数 $\psi : S \rightarrow R\_{\geq 0}$ , 将保护范围称为受单个度量实例 $s\_j$ 保护的ICS组件集。Table 2为Fig.3示例的安全措施表。

<img src="pic\p6\table2.png" width="60%" />

本文同时定义函数 $m: V\_{AT} \rightarrow 2^S$ , 表示给定节点n，返回的保护n的度量实例集。

从图论的角度来看，本文使用基于AND/OR超图的方法将AND/OR依赖图中的每个节点与用于保护它的安全度量实例集链接起来。

## 安全指标

### 问题的定义

设W为工业网络，G=(V,E)是表示W中的操作依赖性的有向AND/OR图，t是目标网络节点。安全度量μ(G,t)的目标是识别受措施 $S(X)=\\{s\_1,...,s\_k\\} \subseteq S$ 保护的一组节点 $X=\\{x\_1,...,x\_h\\}$ ,这些节点必须被破坏才能破坏目标节点t的正常操作，同时使攻击者的成本最低。定义 $S(X) = \cup\_{x\_i \in X} m(x\_i)$ ,且 $\mu: G \times V \rightarrow 2^V$ , 有 

$$\mu (G,t) = argmin\_{X \subseteq V\_{AT}} (\sum_{x\_i \in X}{\phi (x\_i) + \sum\_{s\_j \in S(X)}{\Phi (s\_j)}})$$ , s.t., $wcc(\sigma(G,X)) \geq 2 \vee X = {t}$ —Eq.(1)

其中具有最小代价的解必须是节点t或节点X的集合。函数 $\sigma(G,X)$ 从G中移除每个节点 $x \in X$ 和依赖于它们的节点，遵循逻辑传播。然后使用函数wcc(G)分析结果，该函数计算G中弱连接分量的数量。如果G包含2个及以上分量，则意味着目标节点t与t正常工作所依赖的非空节点集断开。$\Phi(n)$ 可以只考虑安全措施的成本，也可以用网络成本来实例化，如CVSS分数。

### 整体解决过程

包括三个步骤：

1. 将输入AND/OR图转换为表示目标t所依赖的逻辑依赖关系的逻辑公式。
2. 扩展该公式，以捕获保护CPS系统中每个节点的安全措施实例。
3. 将折衷成本(权重)分配给扩展逻辑公式中的变量，使用由此产生的加权公式来解决加权部分MAX-SAT问题，该问题的解决方案将指示应该被破坏的关键节点集和安全措施，以使攻击者的成本最低，从而破坏CPS系统的运行。

## 计算策略

### 逻辑AND/OR依赖关系图的转换

给定目标节点t，输入图G可用作一个映射来解码t的依赖关系，这些依赖关系是以与AND/OR运算符连接的组件的逻辑组合的形式呈现，如果满足逻辑组合，则节点t能正常运行，这些依赖关系也可以有以前的依赖关系，且必须得到满足，因此G可以反向遍历，因此节点t可以以不同方式实现，将这种转换称为 $f\_{G}(t)$ 。攻击者目标恰好相反，即破坏图中节点t，使t失效，即 $\neg f\_{G}(t)$ 。逻辑赋值 $\neg f\_{G}(t) = true$ 表明哪些节点必须被妥协，以破坏系统运行。找到这样的赋值就构成一个可满足性(SAT)问题，SAT问题本质是为逻辑公式的变量分配真值，以便公式评估为真。

考虑示例Fig.2, $f_{G}(t) = t \wedge (d \wedge ((a \wedge b) \vee (b \wedge c)))$, $\neg f\_{G}(t) = \neg (t \wedge (d \wedge ((a \wedge b) \vee (b \wedge c))))$

然而，一般问题涉及用于保护这些节点的安全措施，损害一个节点意味着损害保护它的安全措施，而这些安全措施又可以与其他节点共享(Fig.3)。为了解决这一问题，本文建立了一个通用模型，使用AND/OR超图覆盖基本问题和一般问题。

### 通过AND/OR超图整合重叠的安全措施

超图是标准图的拓展，图中边称为超边，可以连接任意数量的顶点。设X是一组顶点 $X=\\{x\_1, x\_2,...,x\_n\\}$ ,X上的超图H=(X,E)是X的子集族, $E=\\{e\_1, e\_2,...,e\_m\\}$ ,使得H中没有空边, 即 $e\_i \neq \emptyset, \forall e\_i \in E$ ,且X被E覆盖, 即 $\cup\_{i=1}^{m}{e\_i} = X$ 。

本文使用AND/OR超图，结合了超图和AND/OR图的逻辑结构，该图节点为标准超图的超边，且这些节点使用逻辑AND/OR节点进行连接，就像经典AND/OR图一样。

考虑示例Fig.3, 定义超图H=(X,E), $X=V\_{AT} \cup S$ 是节点集, $E = \\{e\_1, e\_2, e\_3, e\_4, e\_5\\}$ 是超边集，Table 3说明了每个超边 $e\_i \in E$ 的成员。

<img src="pic\p6\table3.png" width="40%" />



------

**原文**

Measuring cyber-physical security in industrial control systems via minimum-effort attack strategies

**出版**

- Journal of Information Security and Applications 52 (2020) 102471

**申明**

版权归原文作者及出版单位所有，如有侵权请联系删除